Dựa trên mã nguồn của Nextcloud trên GitHub, tôi có thể mô tả cơ chế xác thực của Nextcloud như sau:

1. Về mặt kỹ thuật:

- Nextcloud sử dụng mô hình xác thực dựa trên phiên (session-based authentication).

- Khi người dùng đăng nhập, hệ thống sẽ tạo một phiên làm việc (session) và lưu thông tin xác thực vào session.

- Mỗi request sau đó sẽ được xác thực bằng cách kiểm tra session token.

- Nextcloud hỗ trợ nhiều phương thức xác thực như:
  + Xác thực cơ bản (username/password)
  + Xác thực qua LDAP/Active Directory
  + Xác thực 2 yếu tố (2FA)
  + Xác thực qua OAuth/OpenID Connect
  + Xác thực qua SAML

- Quá trình xác thực được xử lý chủ yếu trong các file:
  + lib/private/Authentication/
  + lib/private/User/
  + settings/Controller/AuthSettingsController.php

2. Về lưu trữ:

- Thông tin người dùng được lưu trong bảng `oc_users` trong cơ sở dữ liệu.

- Mật khẩu được mã hóa bằng thuật toán bcrypt trước khi lưu.

- Thông tin phiên làm việc được lưu trong bảng `oc_authtoken`.

- Các token xác thực khác như token 2FA, token OAuth được lưu trong các bảng riêng.

- Cấu hình xác thực được lưu trong file config/config.php.

- Nextcloud sử dụng các lớp trừu tượng để có thể sử dụng nhiều backend lưu trữ khác nhau (database, LDAP, etc).

Đây là một cái nhìn tổng quan về cơ chế xác thực của Nextcloud. Nó khá phức tạp và linh hoạt để có thể hỗ trợ nhiều phương thức xác thực khác nhau.
